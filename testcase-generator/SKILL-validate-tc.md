# TC 검증 스킬

<command-name>validate-tc</command-name>

생성된 테스트케이스 Excel 파일의 품질을 검증합니다.

## 트리거

- `/validate-tc`
- `/vtc`

## 자동 트리거 조건

1. **TC 생성 완료 직후** (자동 실행)
2. **키워드 감지**:
   - "검증해줘", "확인해줘", "체크"
   - Excel 파일 + "검증/확인"

## 사용법

```
/validate-tc <Excel_파일_경로>
/validate-tc  # 가장 최근 생성된 TC 자동 선택
```

## 검증 항목

### 1. TC ID 검증
- [ ] 연속성 확인 (001, 002, 003...)
- [ ] 중복 ID 검출
- [ ] 형식 준수 (IT_[PREFIX]_[CODE]_[NUM])

### 2. Depth 검증
- [ ] Depth 1~4 모두 채워짐
- [ ] 계층 구조 일관성
- [ ] 빈 값 검출

### 3. 형식 검증
- [ ] Expected Result `#` 형식
- [ ] Reference 페이지 번호 포함
- [ ] Pre-condition 형식 일관성

### 4. 데이터 무결성
- [ ] 한글 인코딩 정상
- [ ] 셀 병합 정상
- [ ] 드롭다운 목록 정상

## 검증 결과 형식

```
============================================================
  TC 검증 결과
============================================================
파일: 화면정의서_TestCases_20260204.xlsx
총 TC: 53개

✓ TC ID 연속성: 정상
✓ TC ID 중복: 없음
✓ Depth 완전성: 정상
✓ 형식 준수: 정상
✓ 데이터 무결성: 정상

검증 결과: ✅ 통과 (5/5 항목)
------------------------------------------------------------
```

### 오류 발견 시

```
============================================================
  TC 검증 결과
============================================================
파일: 화면정의서_TestCases_20260204.xlsx
총 TC: 53개

✓ TC ID 연속성: 정상
✗ TC ID 중복: 1건 발견
  - IT_OP_015: 행 20, 35에서 중복
✓ Depth 완전성: 정상
✗ 형식 오류: 2건
  - IT_OP_023: Expected Result '#' 누락 (행 28)
  - IT_OP_041: Reference 페이지 번호 누락 (행 46)
✓ 데이터 무결성: 정상

검증 결과: ❌ 실패 (3/5 항목)
------------------------------------------------------------
수정 필요 항목:
1. IT_OP_015 중복 ID 수정
2. IT_OP_023 Expected Result에 '#' 추가
3. IT_OP_041 Reference에 페이지 번호 추가
------------------------------------------------------------
```

## 자동 체이닝

검증 통과 시: `/tc-stats` 자동 실행
검증 실패 시: 문제 해결 가이드 출력

## 문제 해결 가이드

| 오류 유형 | 해결 방법 |
|----------|----------|
| TC ID 중복 | 중복 행 삭제 또는 ID 수정 |
| Depth 누락 | PPTX 구조 재확인, 수동 입력 |
| 형식 오류 | 해당 셀 직접 수정 |
| 인코딩 오류 | UTF-8로 재저장 |
